# -*- coding: utf-8 -*-
"""AvaliacaoNivelSatisfacaoDocentes.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1mCw5YRlWZNJk-z_jc9HnzZq9i5XmhfKW
"""

# ğŸ“Œ ImportaÃ§Ã£o das bibliotecas necessÃ¡rias
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import os

# ğŸ“‚ Caminho do arquivo Excel com as respostas
file_path_xlsx = "/content/AvaliaÃ§Ã£o do NÃ­vel de SatisfaÃ§Ã£o dos ServiÃ§os prestados pelos docentes (respostas)_2.xlsx"
df = pd.read_excel(file_path_xlsx)

# ğŸ”„ Renomear colunas para facilitar a anÃ¡lise
df.columns = [
    "Timestamp", "Email", "Tempo de Estudo", "GÃªnero", "Idade",
    "Conhecimento do Professor", "ExplicaÃ§Ãµes Claras", "Disponibilidade",
    "MÃ©todos de Ensino", "Incentivo Ã  ParticipaÃ§Ã£o", "AvaliaÃ§Ã£o Justa",
    "Feedback", "PreocupaÃ§Ã£o com Alunos", "Ambiente Respeitoso",
    "SatisfaÃ§Ã£o Geral", "ComentÃ¡rios"
]

# âŒ Remover colunas irrelevantes para a anÃ¡lise quantitativa
df = df.drop(columns=["Timestamp", "Email", "ComentÃ¡rios"], errors="ignore")

# ğŸ”¢ Converter respostas textuais em valores numÃ©ricos usando replace() (mais rÃ¡pido)
conversion_dict = {
    "1 - Discordo totalmente": 1,
    "2 - Discordo parcialmente": 2,
    "3 - Neutro": 3,
    "4 - Concordo parcialmente": 4,
    "5 - Concordo totalmente": 5
}

df.replace(conversion_dict, inplace=True)

# ğŸ“‹ Lista de perguntas para anÃ¡lise (agora inclui TODAS as perguntas)
perguntas = list(df.columns)  # Usa todas as colunas como perguntas

# ğŸ“‚ Criar diretÃ³rio para armazenar grÃ¡ficos
output_dir = "graficos"
os.makedirs(output_dir, exist_ok=True)

# ğŸ”¹ FunÃ§Ã£o para gerar e salvar grÃ¡ficos
def gerar_graficos(pergunta):
    print(f"ğŸ“Š Gerando grÃ¡ficos para: {pergunta}")

    # ğŸ“Š GrÃ¡fico de Pizza (apenas para perguntas com valores categÃ³ricos)
    if df[pergunta].dtype == "object":
        fig_pizza = os.path.join(output_dir, f"{pergunta}_pizza.png")
        plt.figure(figsize=(6, 4))
        df[pergunta].value_counts().plot.pie(
            autopct='%1.1f%%', cmap="Blues", startangle=90, wedgeprops={'edgecolor': 'black'}
        )
        plt.title(f"DistribuiÃ§Ã£o das Respostas - {pergunta}")
        plt.ylabel("")
        plt.savefig(fig_pizza)
        plt.close()

    # ğŸ“ˆ Histograma (para perguntas quantitativas)
    if df[pergunta].dtype in ["int64", "float64"]:
        fig_hist = os.path.join(output_dir, f"{pergunta}_hist.png")
        plt.figure(figsize=(6, 4))
        sns.histplot(df[pergunta], bins=5, kde=True, color="royalblue")
        plt.title(f"FrequÃªncia das Respostas - {pergunta}")
        plt.xlabel("NÃ­vel de ConcordÃ¢ncia")
        plt.ylabel("FrequÃªncia")
        plt.xticks(range(1, 6))
        plt.savefig(fig_hist)
        plt.close()

        # ğŸ“Š Boxplot
        fig_box = os.path.join(output_dir, f"{pergunta}_boxplot.png")
        plt.figure(figsize=(6, 4))
        sns.boxplot(x=df[pergunta], color="skyblue")
        plt.title(f"VariaÃ§Ã£o das Respostas - {pergunta}")
        plt.xlabel("NÃ­vel de ConcordÃ¢ncia")
        plt.savefig(fig_box)
        plt.close()

# ğŸ“Š Loop para gerar grÃ¡ficos para TODAS as perguntas
for pergunta in perguntas:
    gerar_graficos(pergunta)

print("âœ… Todos os grÃ¡ficos foram gerados e salvos na pasta 'graficos'.")